<div class="profile-container" style="max-width: 800px; margin: 30px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
<h2 style="text-align: center;">Mon Profil</h2>

  @if (message) {
    <div style="background-color: #d1ecf1; color: #0c5460; padding: 10px; margin-bottom: 15px;">
      {{ message }}
    </div>
  }

  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
    
    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
      <div style="flex: 1;">
        <label>Nom</label>
        <input type="text" formControlName="nom" style="width: 100%; padding: 8px;">
      </div>
      <div style="flex: 1;">
        <label>Prénom</label>
        <input type="text" formControlName="prenom" style="width: 100%; padding: 8px;">
      </div>
    </div>

    <div style="margin-bottom: 10px;">
      <label>Email (Non modifiable)</label>
      <input type="email" formControlName="email" style="width: 100%; padding: 8px; background: #f0f0f0;">
    </div>

    <div style="margin-bottom: 10px;">
      <label>Téléphone</label>
      <input type="text" formControlName="telephone" style="width: 100%; padding: 8px;">
    </div>

    <hr style="margin: 20px 0;">
    <h3>Adresse</h3>

    <div style="margin-bottom: 10px;">
      <label>Rue</label>
      <input type="text" formControlName="rue" style="width: 100%; padding: 8px;">
    </div>

    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
      <div style="flex: 1;">
        <label>Code Postal</label>
        <input type="text" formControlName="code_postal" style="width: 100%; padding: 8px;">
      </div>
      <div style="flex: 2;">
        <label>Ville</label>
        <input type="text" formControlName="ville" style="width: 100%; padding: 8px;">
      </div>
    </div>

    <div style="margin-bottom: 20px;">
      <label>Pays</label>
      <input type="text" formControlName="pays" style="width: 100%; padding: 8px;">
    </div>

    <button type="submit" [disabled]="profileForm.invalid" style="width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; cursor: pointer;">
      Enregistrer les modifications
    </button>
  </form>

<hr style="margin: 40px 0; border: 0; border-top: 1px solid #ddd;">

<div class="bookings-section">
  <h2>Mes Réservations</h2>

  @if (loadingBookings) {
    <p>Chargement de l'historique...</p>
  } @else if (bookings.length === 0) {
    <p>Vous n'avez pas encore effectué de réservation.</p>
    <a routerLink="/" style="color: #007bff;">Découvrir nos hôtels</a>
  } @else {
    
    <div style="overflow-x: auto;">
      <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
        <thead>
          <tr style="background-color: #f8f9fa; text-align: left;">
            <th style="padding: 12px; border-bottom: 2px solid #ddd;">Hôtel</th>
            <th style="padding: 12px; border-bottom: 2px solid #ddd;">Dates</th>
            <th style="padding: 12px; border-bottom: 2px solid #ddd;">Prix</th>
            <th style="padding: 12px; border-bottom: 2px solid #ddd;">Statut</th>
            <th style="padding: 12px; border-bottom: 2px solid #ddd;">Action</th>
          </tr>
        </thead>
        <tbody>
          @for (booking of bookings; track booking.id_commande) {
            <tr style="border-bottom: 1px solid #eee;">
              
              <td style="padding: 12px;">
                <strong>{{ booking.hotel_name }}</strong><br>
                <small style="color: #666;">{{ booking.hotel_city }}</small>
              </td>

              <td style="padding: 12px;">
                Du {{ booking.date_sejour_debut | date:'dd/MM/yyyy' }}<br>
                au {{ booking.date_sejour_fin | date:'dd/MM/yyyy' }}
              </td>

              <td style="padding: 12px; font-weight: bold;">
                {{ booking.montant_total | currency:'EUR' }}
              </td>

              <td style="padding: 12px;">
                <span [style.color]="getStatusColor(booking.statut_commande)" style="font-weight: bold; text-transform: capitalize;">
                  {{ booking.statut_commande }}
                </span>
              </td>

              <td style="padding: 12px;">
                <a [routerLink]="['/hotel', booking.id_hotel]" style="color: #007bff; text-decoration: none; font-size: 0.9rem;">
                  Voir l'hôtel
                </a>
              </td>

            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>

</div>